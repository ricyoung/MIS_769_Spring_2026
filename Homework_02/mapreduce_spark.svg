<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 780" width="900" height="780">
  <defs>
    <linearGradient id="mapGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#cc4444;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="shuffleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#cc9900;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="reduceGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4ecdc4;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#26a69a;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="sparkGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ff9500;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#cc7700;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="3" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="780" fill="#1a1a2e"/>

  <!-- ==================== MAPREDUCE SECTION ==================== -->
  <g transform="translate(30, 20)">
    <rect x="0" y="0" width="840" height="460" rx="10" fill="#1f1f35" stroke="#3a3a5a" stroke-width="1"/>
    <rect x="0" y="0" width="840" height="8" rx="4" fill="url(#mapGrad)"/>

    <text x="420" y="35" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="20" font-weight="bold" fill="white" text-anchor="middle">MapReduce</text>
    <text x="420" y="55" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="12" fill="#888" text-anchor="middle">Divide big problems into small parallel tasks</text>

    <!-- TECHNICAL DATA FLOW -->
    <g transform="translate(20, 70)">
      <!-- Input -->
      <g transform="translate(0, 0)">
        <rect x="0" y="0" width="100" height="70" rx="6" fill="#252540" filter="url(#shadow)"/>
        <text x="50" y="22" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#4a9eff" text-anchor="middle">INPUT</text>
        <text x="50" y="40" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#888" text-anchor="middle">Raw data</text>
        <text x="50" y="52" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#888" text-anchor="middle">split into chunks</text>
      </g>

      <!-- Arrow -->
      <g transform="translate(110, 30)">
        <line x1="0" y1="0" x2="30" y2="0" stroke="#ff6b6b" stroke-width="2"/>
        <polygon points="30,0 23,-5 23,5" fill="#ff6b6b"/>
      </g>

      <!-- MAP -->
      <g transform="translate(150, 0)">
        <rect x="0" y="0" width="150" height="70" rx="6" fill="#252540" filter="url(#shadow)"/>
        <rect x="0" y="0" width="150" height="5" rx="2" fill="url(#mapGrad)"/>
        <text x="75" y="22" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#ff6b6b" text-anchor="middle">MAP</text>
        <text x="75" y="40" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#ddd" text-anchor="middle">Transform each record</text>
        <text x="75" y="52" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#ff6b6b" text-anchor="middle">emit (key, value)</text>
      </g>

      <!-- Arrow -->
      <g transform="translate(310, 30)">
        <line x1="0" y1="0" x2="30" y2="0" stroke="#ffd700" stroke-width="2"/>
        <polygon points="30,0 23,-5 23,5" fill="#ffd700"/>
      </g>

      <!-- SHUFFLE -->
      <g transform="translate(350, 0)">
        <rect x="0" y="0" width="150" height="70" rx="6" fill="#252540" filter="url(#shadow)"/>
        <rect x="0" y="0" width="150" height="5" rx="2" fill="url(#shuffleGrad)"/>
        <text x="75" y="22" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#ffd700" text-anchor="middle">SHUFFLE</text>
        <text x="75" y="40" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#ddd" text-anchor="middle">Sort and group by key</text>
        <text x="75" y="52" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#ffd700" text-anchor="middle">(key, [v1, v2, ...])</text>
      </g>

      <!-- Arrow -->
      <g transform="translate(510, 30)">
        <line x1="0" y1="0" x2="30" y2="0" stroke="#4ecdc4" stroke-width="2"/>
        <polygon points="30,0 23,-5 23,5" fill="#4ecdc4"/>
      </g>

      <!-- REDUCE -->
      <g transform="translate(550, 0)">
        <rect x="0" y="0" width="150" height="70" rx="6" fill="#252540" filter="url(#shadow)"/>
        <rect x="0" y="0" width="150" height="5" rx="2" fill="url(#reduceGrad)"/>
        <text x="75" y="22" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#4ecdc4" text-anchor="middle">REDUCE</text>
        <text x="75" y="40" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#ddd" text-anchor="middle">Aggregate values</text>
        <text x="75" y="52" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#4ecdc4" text-anchor="middle">(key, result)</text>
      </g>

      <!-- Arrow -->
      <g transform="translate(710, 30)">
        <line x1="0" y1="0" x2="30" y2="0" stroke="#4a9eff" stroke-width="2"/>
        <polygon points="30,0 23,-5 23,5" fill="#4a9eff"/>
      </g>

      <!-- OUTPUT -->
      <g transform="translate(750, 0)">
        <rect x="0" y="0" width="70" height="70" rx="6" fill="#252540" filter="url(#shadow)"/>
        <text x="35" y="22" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#4a9eff" text-anchor="middle">OUTPUT</text>
        <text x="35" y="40" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#888" text-anchor="middle">Final</text>
        <text x="35" y="52" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#888" text-anchor="middle">results</text>
      </g>
    </g>

    <!-- LIBRARY ANALOGY -->
    <g transform="translate(20, 155)">
      <rect x="0" y="0" width="800" height="130" rx="8" fill="#252540"/>
      <text x="400" y="22" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="13" font-weight="bold" fill="#9966cc" text-anchor="middle">ðŸ“š The Library Analogy</text>

      <!-- Problem -->
      <g transform="translate(20, 38)">
        <text x="0" y="14" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#888">The Problem:</text>
        <text x="90" y="14" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" fill="#ddd">A patron needs 100 books. One librarian would take forever.</text>
      </g>

      <!-- MAP -->
      <g transform="translate(20, 60)">
        <circle cx="8" cy="8" r="6" fill="#ff6b6b"/>
        <text x="22" y="12" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#ff6b6b">MAP:</text>
        <text x="60" y="12" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" fill="#ddd">Split the list among 10 student workers. Each finds their 10 books in parallel.</text>
      </g>

      <!-- SHUFFLE -->
      <g transform="translate(20, 82)">
        <circle cx="8" cy="8" r="6" fill="#ffd700"/>
        <text x="22" y="12" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#ffd700">SHUFFLE:</text>
        <text x="75" y="12" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" fill="#ddd">Students bring books back. Group them by floor/section for easy shelving later.</text>
      </g>

      <!-- REDUCE -->
      <g transform="translate(20, 104)">
        <circle cx="8" cy="8" r="6" fill="#4ecdc4"/>
        <text x="22" y="12" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#4ecdc4">REDUCE:</text>
        <text x="75" y="12" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" fill="#ddd">Combine into one organized cart, sorted so patron can find any book quickly.</text>
      </g>
    </g>

    <!-- VISUAL FLOW WITH ICONS -->
    <g transform="translate(20, 295)">
      <!-- Input Data -->
      <g transform="translate(0, 0)">
        <rect x="0" y="0" width="120" height="70" rx="6" fill="#252540" filter="url(#shadow)"/>
        <text x="60" y="18" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#4a9eff" text-anchor="middle">ðŸ“‹ Book List</text>
        <text x="60" y="36" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#888" text-anchor="middle">Book A, Book B,</text>
        <text x="60" y="48" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#888" text-anchor="middle">Book C ... 100 books</text>
      </g>

      <!-- Arrow -->
      <g transform="translate(130, 30)">
        <line x1="0" y1="0" x2="25" y2="0" stroke="#ff6b6b" stroke-width="2"/>
        <polygon points="25,0 18,-5 18,5" fill="#ff6b6b"/>
      </g>

      <!-- MAP Phase -->
      <g transform="translate(165, 0)">
        <rect x="0" y="0" width="180" height="70" rx="6" fill="#252540" filter="url(#shadow)"/>
        <rect x="0" y="0" width="180" height="5" rx="2" fill="url(#mapGrad)"/>
        <text x="90" y="20" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#ff6b6b" text-anchor="middle">MAP (Split + Find)</text>
        <!-- Workers -->
        <g transform="translate(15, 28)">
          <rect x="0" y="0" width="45" height="34" rx="4" fill="#3a3a5a"/>
          <text x="22" y="14" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="14" text-anchor="middle">ðŸ‘¤</text>
          <text x="22" y="28" font-family="SF Mono, Menlo, monospace" font-size="7" fill="#ff6b6b" text-anchor="middle">10 books</text>
        </g>
        <g transform="translate(68, 28)">
          <rect x="0" y="0" width="45" height="34" rx="4" fill="#3a3a5a"/>
          <text x="22" y="14" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="14" text-anchor="middle">ðŸ‘¤</text>
          <text x="22" y="28" font-family="SF Mono, Menlo, monospace" font-size="7" fill="#ff6b6b" text-anchor="middle">10 books</text>
        </g>
        <g transform="translate(121, 28)">
          <rect x="0" y="0" width="45" height="34" rx="4" fill="#3a3a5a"/>
          <text x="22" y="14" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="14" text-anchor="middle">ðŸ‘¤</text>
          <text x="22" y="28" font-family="SF Mono, Menlo, monospace" font-size="7" fill="#ff6b6b" text-anchor="middle">10 books</text>
        </g>
      </g>

      <!-- Arrow -->
      <g transform="translate(355, 30)">
        <line x1="0" y1="0" x2="25" y2="0" stroke="#ffd700" stroke-width="2"/>
        <polygon points="25,0 18,-5 18,5" fill="#ffd700"/>
      </g>

      <!-- SHUFFLE Phase -->
      <g transform="translate(390, 0)">
        <rect x="0" y="0" width="180" height="70" rx="6" fill="#252540" filter="url(#shadow)"/>
        <rect x="0" y="0" width="180" height="5" rx="2" fill="url(#shuffleGrad)"/>
        <text x="90" y="20" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#ffd700" text-anchor="middle">SHUFFLE (Group)</text>
        <!-- Grouped stacks -->
        <g transform="translate(15, 28)">
          <rect x="0" y="0" width="45" height="34" rx="4" fill="#3a3a5a"/>
          <text x="22" y="14" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="12" text-anchor="middle">ðŸ“š</text>
          <text x="22" y="28" font-family="SF Mono, Menlo, monospace" font-size="7" fill="#ffd700" text-anchor="middle">Floor 1</text>
        </g>
        <g transform="translate(68, 28)">
          <rect x="0" y="0" width="45" height="34" rx="4" fill="#3a3a5a"/>
          <text x="22" y="14" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="12" text-anchor="middle">ðŸ“š</text>
          <text x="22" y="28" font-family="SF Mono, Menlo, monospace" font-size="7" fill="#ffd700" text-anchor="middle">Floor 2</text>
        </g>
        <g transform="translate(121, 28)">
          <rect x="0" y="0" width="45" height="34" rx="4" fill="#3a3a5a"/>
          <text x="22" y="14" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="12" text-anchor="middle">ðŸ“š</text>
          <text x="22" y="28" font-family="SF Mono, Menlo, monospace" font-size="7" fill="#ffd700" text-anchor="middle">Floor 3</text>
        </g>
      </g>

      <!-- Arrow -->
      <g transform="translate(580, 30)">
        <line x1="0" y1="0" x2="25" y2="0" stroke="#4ecdc4" stroke-width="2"/>
        <polygon points="25,0 18,-5 18,5" fill="#4ecdc4"/>
      </g>

      <!-- REDUCE Phase -->
      <g transform="translate(615, 0)">
        <rect x="0" y="0" width="180" height="70" rx="6" fill="#252540" filter="url(#shadow)"/>
        <rect x="0" y="0" width="180" height="5" rx="2" fill="url(#reduceGrad)"/>
        <text x="90" y="20" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#4ecdc4" text-anchor="middle">REDUCE (Combine)</text>
        <g transform="translate(40, 26)">
          <rect x="0" y="0" width="100" height="36" rx="4" fill="#3a3a5a"/>
          <text x="50" y="16" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="14" text-anchor="middle">ðŸ›’</text>
          <text x="50" y="30" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#4ecdc4" text-anchor="middle">Organized cart</text>
        </g>
      </g>
    </g>

    <!-- CODE EXAMPLES -->
    <g transform="translate(20, 380)">
      <text x="0" y="14" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11" font-weight="bold" fill="#888">Real Examples:</text>

      <!-- Example 1: Word Count -->
      <g transform="translate(100, 0)">
        <rect x="0" y="0" width="320" height="55" rx="6" fill="#252540"/>
        <text x="10" y="16" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="10" font-weight="bold" fill="#9966cc">Word Count</text>
        <text x="10" y="32" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#888">Input:</text>
        <text x="50" y="32" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#ddd">"the cat sat on the mat"</text>
        <text x="10" y="46" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#888">Output:</text>
        <text x="55" y="46" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#4ecdc4">{the: 2, cat: 1, sat: 1, on: 1, mat: 1}</text>
      </g>

      <!-- Example 2: Sales by Region -->
      <g transform="translate(440, 0)">
        <rect x="0" y="0" width="355" height="55" rx="6" fill="#252540"/>
        <text x="10" y="16" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="10" font-weight="bold" fill="#9966cc">Total Sales by Region</text>
        <text x="10" y="32" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#888">Input:</text>
        <text x="50" y="32" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#ddd">(West,$50), (East,$30), (West,$20), (East,$40)</text>
        <text x="10" y="46" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#888">Output:</text>
        <text x="55" y="46" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#4ecdc4">{West: $70, East: $70}</text>
      </g>
    </g>
  </g>

  <!-- ==================== SPARK SECTION ==================== -->
  <g transform="translate(30, 495)">
    <rect x="0" y="0" width="840" height="170" rx="10" fill="#1f1f35" stroke="#3a3a5a" stroke-width="1"/>
    <rect x="0" y="0" width="840" height="8" rx="4" fill="url(#sparkGrad)"/>

    <text x="420" y="32" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="18" font-weight="bold" fill="white" text-anchor="middle">Apache Spark</text>
    <text x="420" y="50" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="12" fill="#888" text-anchor="middle">Same MapReduce concept, but faster and easier to write</text>

    <!-- Spark flow -->
    <g transform="translate(40, 65)">
      <rect x="0" y="0" width="100" height="45" rx="6" fill="#252540" filter="url(#shadow)"/>
      <text x="50" y="18" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="10" font-weight="bold" fill="#ff9500" text-anchor="middle">DataFrame</text>
      <text x="50" y="35" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#888" text-anchor="middle">Your data</text>
    </g>

    <g transform="translate(150, 82)">
      <line x1="0" y1="0" x2="25" y2="0" stroke="#ff9500" stroke-width="2"/>
      <polygon points="25,0 18,-5 18,5" fill="#ff9500"/>
    </g>

    <g transform="translate(185, 65)">
      <rect x="0" y="0" width="200" height="45" rx="6" fill="#252540" filter="url(#shadow)"/>
      <text x="100" y="18" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="10" font-weight="bold" fill="#ff9500" text-anchor="middle">Transformations (lazy)</text>
      <text x="100" y="35" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#ddd" text-anchor="middle">.filter() .groupBy() .agg()</text>
    </g>

    <g transform="translate(395, 82)">
      <line x1="0" y1="0" x2="25" y2="0" stroke="#4ecdc4" stroke-width="2"/>
      <polygon points="25,0 18,-5 18,5" fill="#4ecdc4"/>
    </g>

    <g transform="translate(430, 65)">
      <rect x="0" y="0" width="140" height="45" rx="6" fill="#252540" filter="url(#shadow)"/>
      <text x="70" y="18" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="10" font-weight="bold" fill="#4ecdc4" text-anchor="middle">Actions (run it!)</text>
      <text x="70" y="35" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#ddd" text-anchor="middle">.show() .count()</text>
    </g>

    <g transform="translate(580, 82)">
      <line x1="0" y1="0" x2="25" y2="0" stroke="#4ecdc4" stroke-width="2"/>
      <polygon points="25,0 18,-5 18,5" fill="#4ecdc4"/>
    </g>

    <g transform="translate(615, 65)">
      <rect x="0" y="0" width="80" height="45" rx="6" fill="#252540" filter="url(#shadow)"/>
      <text x="40" y="18" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="10" font-weight="bold" fill="#4ecdc4" text-anchor="middle">Result</text>
      <text x="40" y="35" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#888" text-anchor="middle">Output</text>
    </g>

    <g transform="translate(715, 65)">
      <rect x="0" y="0" width="105" height="45" rx="6" fill="#2a4a5a"/>
      <text x="52" y="18" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="9" font-weight="bold" fill="#4a9eff" text-anchor="middle">âš¡ IN-MEMORY</text>
      <text x="52" y="35" font-family="SF Mono, Menlo, monospace" font-size="8" fill="#4a9eff" text-anchor="middle">10-100x faster</text>
    </g>

    <!-- Code example -->
    <g transform="translate(40, 125)">
      <text x="0" y="12" font-family="SF Mono, Menlo, monospace" font-size="10" fill="#888"># Same word count in Spark - one line!</text>
      <text x="0" y="30" font-family="SF Mono, Menlo, monospace" font-size="11" fill="#ff9500">df</text>
      <text x="15" y="30" font-family="SF Mono, Menlo, monospace" font-size="11" fill="#ddd">.groupBy(</text>
      <text x="85" y="30" font-family="SF Mono, Menlo, monospace" font-size="11" fill="#9966cc">"word"</text>
      <text x="130" y="30" font-family="SF Mono, Menlo, monospace" font-size="11" fill="#ddd">).count().show()</text>
    </g>
  </g>

  <!-- ==================== BOTTOM SECTION ==================== -->
  <g transform="translate(30, 680)">
    <rect x="0" y="0" width="840" height="80" rx="8" fill="#252540" filter="url(#shadow)"/>
    <rect x="0" y="0" width="840" height="6" rx="3" fill="#4a9eff"/>

    <text x="420" y="28" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="13" font-weight="bold" fill="#4a9eff" text-anchor="middle">What You'll Practice</text>

    <g transform="translate(50, 42)" font-family="SF Pro Display, SF Pro, -apple-system, sans-serif" font-size="11">
      <circle cx="0" cy="8" r="4" fill="#ff6b6b"/>
      <text x="12" y="12" fill="#ddd">Think in Map-Shuffle-Reduce steps</text>

      <circle cx="250" cy="8" r="4" fill="#ffd700"/>
      <text x="262" y="12" fill="#ddd">Write PySpark transformations</text>

      <circle cx="480" cy="8" r="4" fill="#4ecdc4"/>
      <text x="492" y="12" fill="#ddd">Aggregate data at scale</text>
    </g>

    <text x="420" y="70" font-family="SF Mono, Menlo, monospace" font-size="9" fill="#666" text-anchor="middle">The same pattern powers Google, Netflix, Uber, and Spotify's data pipelines</text>
  </g>

</svg>
